#! /usr/bin/env sh

PLAY_VERSION="2.0-SNAPSHOT"

if [ -z "${JPDA_PORT}" ]; then
  DEBUG_PARAM=""
else
  DEBUG_PARAM="-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=${JPDA_PORT}"
fi

dir=`dirname $0`
if [ `uname -o` == "Cygwin" ]
then
  SBT_IVY_HOME=$(cygpath -w -a $dir/../repository)
  PLAY_HOME=$(cygpath -w -a $dir)
  SBT_LAUNCH_JAR=$(cygpath -w -a $dir/sbt/sbt-launch.jar)
  SBT_BOOT_PROPS=file:///$(cygpath -m -a $dir/sbt/sbt.boot.properties)
  JLINE_TERMINAL=-Djline.terminal=jline.UnixTerminal
else 
  SBT_IVY_HOME=$dir/../repository
  PLAY_HOME=$dir
  SBT_LAUNCH_JAR=$PLAY_HOME/sbt/sbt-launch.jar
  SBT_BOOT_PROPS=$PLAY_HOME/sbt/sbt.boot.properties
fi

JAVA_ARGS="-Xms512M -Xmx1536M -Xss1M -XX:+CMSClassUnloadingEnabled -XX:MaxPermSize=384M $JLINE_TERMINAL -Dfile.encoding=UTF8 -Dplay.version="${PLAY_VERSION}" -Dsbt.ivy.home=$SBT_IVY_HOME -Dplay.home=$PLAY_HOME -Dsbt.boot.properties=$SBT_BOOT_PROPS"

java ${DEBUG_PARAM} ${JAVA_ARGS} -jar $SBT_LAUNCH_JAR "$@"
