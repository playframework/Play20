#!/usr/bin/env bash

# Copyright (C) 2009-2018 Lightbend Inc. <https://www.lightbend.com>

. "$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/scriptLib"

cd ${FRAMEWORK}

# Don't build first, let sbt automatically build any dependencies that
# are needed when we run the microbenchmarks. This should be quicker
# than doing an explicit publish step.

printMessage "VALIDATING MICROBENCHMARKS"

# Just run single iteration of microbenchmark to test that they
# run properly. The results will be inaccurate, but this ensures that
# the microbenchmarks at least compile and run.

# We are using double-double quotes here so that the command
# is passed to runSbt as a single command and internally be
# passed to sbt as a single command too.
runSbtNoisy "Play-Microbenchmark/jmh:run -i 1 -wi 0 -f 1 -t 1"

printMessage "BENCHMARKS VALIDATED"
