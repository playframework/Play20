#!/usr/bin/env bash

# Copyright (C) 2009-2018 Lightbend Inc. <https://www.lightbend.com>

. "$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/scriptLib"

cd ${DOCUMENTATION}

printMessage "RUNNING DOCUMENTATION TESTS"
runSbtNoisy test
runSbtNoisy evaluateSbtFiles
runSbt validateDocs

printMessage "ALL DOCUMENTATION TESTS PASSED"

# Check that sample code have copyright headers
runSbt checkHeaders test:checkHeaders

# Check that markdown files have copyright headers
./addMarkdownCopyright

git diff --exit-code || (
  echo "ERROR: Documentation copyright check failed, see differences above."
  echo "To fix, run './addMarkdownCopyright' script inside documentation directory."
  echo "After that you can update your pull request."
  false
)
